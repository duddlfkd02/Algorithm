/* ğŸ§  ë¬¸ì œ ì„¤ëª…

í¬ê¸°ê°€ N x Mì¸ ê²©ìê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤.
ê° ì¹¸ì€ 0(ê¸¸) ë˜ëŠ” 1(ë²½)ìœ¼ë¡œ ë˜ì–´ ìˆê³ ,
ì¶œë°œì  (1,1)ì—ì„œ ë„ì°©ì  (N,M)ê¹Œì§€ ì´ë™í•˜ë ¤ê³  í•©ë‹ˆë‹¤.
	â€¢	ìƒí•˜ì¢Œìš° ë„¤ ë°©í–¥ìœ¼ë¡œë§Œ ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
	â€¢	ë‹¨, ë‹¨ í•œ ë²ˆë§Œ(ìµœëŒ€ í•œ ì¹¸ë§Œ) ë²½(1)ì„ ë¶€ìˆ˜ê³  ì§€ë‚˜ê°ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
	â€¢	ë¶€ìˆœ ë²½ì„ ì§€ë‚˜ê°„ ë’¤ì—ëŠ” ë” ì´ìƒ ë²½ì„ ë¶€ìˆ  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.

ì¶œë°œì ì—ì„œ ë„ì°©ì ê¹Œì§€ ê°€ëŠ” **ìµœë‹¨ ê±°ë¦¬(ì´ë™ íšŸìˆ˜ + 1)**ë¥¼ êµ¬í•˜ì„¸ìš”.
ë§Œì•½ ë„ë‹¬í•  ìˆ˜ ì—†ìœ¼ë©´ -1ì„ ì¶œë ¥í•©ë‹ˆë‹¤.

âœ… ì…ë ¥
ì²« ë²ˆì§¸ ì¤„: ì •ìˆ˜ N, M   (1 â‰¤ N, M â‰¤ 1000)
ë‹¤ìŒ Nì¤„: ê° ì¤„ë§ˆë‹¤ ê¸¸ì´ Mì¸ ë¬¸ìì—´ (ë¬¸ì `'0'` ë˜ëŠ” `'1'`)


âœ… ì¶œë ¥
	â€¢	ì¶œë°œì  (1,1)ì—ì„œ ë„ì°©ì  (N,M)ê¹Œì§€ ìµœë‹¨ ê±°ë¦¬(ì¹¸ ê°œìˆ˜)ë¥¼ ì¶œë ¥
	â€¢	ì´ë™í•  ìˆ˜ ì—†ìœ¼ë©´ -1

*/

const inputLines = ["6 4", "0100", "1110", "1000", "0000", "0111", "0000"];

function solution(input) {
  const [N, M] = input[0].split(" ").map(Number);
  const maze = Array.from({ length: N }, (_, i) =>
    input[i + 1]
      .trim()
      .split("")
      .map((ch) => Number(ch))
  );

  // visited[x][y][b]: x,y ìœ„ì¹˜ë¥¼ ë²½ bë²ˆ ë¶€ìˆœ ìƒíƒœë¡œ ë°©ë¬¸í–ˆëŠ”ì§€
  const visited = Array.from({ length: N }, () =>
    Array.from({ length: M }, () => [false, false])
  );
  // dist[x][y][b]: ë²½ bë²ˆ ë¶€ìˆœ ìƒíƒœë¡œ x,yê¹Œì§€ ì˜¨ ìµœë‹¨ ì¹¸ ìˆ˜
  const dist = Array.from({ length: N }, () =>
    Array.from({ length: M }, () => [0, 0])
  );

  const dx = [-1, 1, 0, 0];
  const dy = [0, 0, -1, 1];
  const queue = [];

  visited[0][0][0] = true;
  dist[0][0][0] = 1;
  queue.push([0, 0, 0]); // ë²½ì„ ì•„ì§ ì•ˆ ë¶€ìˆœ ìƒíƒœ

  // Step 3. BFS íƒìƒ‰
  while (queue.length > 0) {
    const [x, y, b] = queue.shift();
    const cd = dist[x][y][b]; // currDist: (x,y,b) ìƒíƒœê¹Œì§€ ì§€ë‚˜ì˜¨ ì¹¸ ìˆ˜

    // ë„ì°© ì§€ì ì— ë„ë‹¬í–ˆë‹¤ë©´, ì—¬ê¸°ê°€ ìµœë‹¨ ê±°ë¦¬
    if (x === N - 1 && y === M - 1) {
      console.log(cd);
      return;
    }

    // ë„¤ ë°©í–¥ íƒìƒ‰
    for (let dir = 0; dir < 4; dir++) {
      const nx = x + dx[dir];
      const ny = y + dy[dir];

      // ë²”ìœ„ ë²—ì–´ë‚˜ë©´ íŒ¨ìŠ¤
      if (nx < 0 || ny < 0 || nx >= N || ny >= M) continue;

      // ê¸¸(0)ì´ë¼ë©´?
      if (maze[nx][ny] === 0) {
        // ë²½ì„ bë²ˆ ë¶€ìˆœ ìƒíƒœë¡œ ë°©ë¬¸í•´ ë³¸ ì  ì—†ìœ¼ë©´
        if (!visited[nx][ny][b]) {
          visited[nx][ny][b] = true;
          dist[nx][ny][b] = cd + 1;
          queue.push([nx, ny, b]);
        }
      }
      //  ë²½(1)ì¸ ê²½ìš° (ë²½ì„ ì•„ì§ ì•ˆ ë¶€ìˆœ ìƒíƒœ)
      else if (maze[nx][ny] === 1 && b === 0) {
        // ë²½ì„ í•œ ë²ˆ ë¶€ìˆœ ë’¤ ìƒíƒœ(b=1)ë¡œ ë°©ë¬¸í•œ ì  ì—†ìœ¼ë©´
        if (!visited[nx][ny][1]) {
          visited[nx][ny][1] = true;
          dist[nx][ny][1] = cd + 1;
          queue.push([nx, ny, 1]);
        }
      }
    }
  }

  // BFSê°€ ëë‚¬ëŠ”ë°ë„ ë„ì°©ì ì— ëª» ê°€ë©´ -1 ì¶œë ¥
  console.log(-1);
}

console.log(solution(inputLines));
